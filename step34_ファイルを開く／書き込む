では、📘 PHP基礎入門 Step34：「ファイルを開く／書き込む」 を始めましょう。



🎯 学習目的

このステップでは PHPでファイルを操作する基本 を学びます。
具体的には、ファイルを「開いて」「書き込む」処理を理解します。



🧱 なぜ重要なのか

PHPはWebサーバー上で動く言語ですが、データをファイルとして保存・読み出しできることは非常に重要です。
例えば以下のような場面で使われます。

Webフォームから送られたデータをテキストファイルに保存する
ログを出力してトラブルを追跡する
データベースを使わない簡易的なメモ帳や掲示板を作る

つまり、ファイル操作は 「永続的なデータ保存」 の第一歩です。



🧩 基本例（例文コード）

ファイルに書き込む最も基本的なコードを見てみましょう。

📄 step34_file_write.php

<?php

// 書き込みたい内容
$text = "こんにちは、PHPのファイル操作です。\n";

// ファイルを開く（fopen）
// "a" は「追記モード（append）」を意味する
$file = fopen("sample.txt", "a");

// fwrite で内容を書き込む
fwrite($file, $text);

// ファイルを閉じる（必ず必要）
fclose($file);

echo "書き込みが完了しました。";

?>



🔍 コード解説

fopen("sample.txt", "a")
　ファイルを開く関数です。
　モード "a" は「追記モード」で、既存の内容の末尾に追加されます。

　主なモード：
　- "w"：上書きモード（既存内容を消す）
　- "a"：追記モード（内容を追加）
　- "r"：読み取り専用

fwrite()
　開いたファイルに文字列を書き込みます。

fclose()
　開いたファイルを閉じます。これをしないとデータが正しく保存されないことがあります。

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

✅ 練習問題1

次の要件でファイルを書き込むコードを作成してください。

📄 step34_practice1.php

要件：
ファイル名は log.txt

書き込む内容は「今日のPHP学習を開始します。\n」
モードは「追記モード」
書き込み完了後に「log.txtに書き込みました。」と表示

あなたのコードをここに貼ってください。
先生として正誤と解説をします。

<?php

$text = "今日のPHP学習を開始します。\n";

$file = fopen("sample.text", "a");

fwrite($file,$text);

fclose($file);

echo "log.txtに書き込みました。\n";

?>

✅ 送っていただいたコードを確認しました！

まず結果からお伝えします：

❌ 修正が必要なポイント

ファイル名が sample.text になっています。
要件では log.txt が正しいファイル名です。

- $file = fopen("sample.text", "a");
+ $file = fopen("log.txt", "a");

また、表示文と言っているファイル名が一致していません。


📌 補足（本質理解）
fopen() の第1引数＝ 実際に書き込みたいファイル名
ここが1文字でも間違うと 別のファイルが作られる or 書き込まれない

サーバー側のLinux環境では大文字小文字の違いも別ファイル扱い
→ 表示文と実際のファイル名が一致していることを常に確認が必要です。

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

練習問題修正版：

<?php

$text = "今日のPHP学習を開始します。\n";

$file = fopen("log.txt", "a");

fwrite($file,$text);

fclose($file);

echo "log.txtに書き込みました。\n";

?>

✅ ばっちり完璧です！！
要件どおり書けています👏👏👏

次に進みましょう！

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

✅ 練習問題2（応用度UP）

📄 ファイル名： step34_practice2.php

要件：

ファイル名は memo.txt

今日の日付（例：2025-10-24）を
date() 関数を使って自動で取得する

内容は次の形式で追記する：

2025-10-24: 今日もPHP頑張るぞ！

書き込み完了後に
「memo.txtに追記しました。」
と表示する

ヒント（※希望があれば参照）

date("Y-m-d") → 「2025-10-24」形式になる

📌 ヒントは不要とのことでしたら見ずに挑戦してください！
📌 書き込み内容の最後には \n をつけてください

準備できたら、コードを貼ってください。
正誤チェック＆解説をします！
頑張りましょう💪✨


<?php

date("y-m-d");

$text = "date("y-m-d") . : 今日もPHP頑張るぞ！\n";

$file = fopen("memo.txt", "a");

fwrite($file,$text);

fclose($file);

echo "memo.txtに追記しました\n";

?>

コード提出ありがとうございます！
しっかり取り組めていますが、2つの重要な修正ポイントがあります。

❌ 修正ポイント

① date() が 文字列に埋め込まれていない
② 文字列内で ダブルクォーテーションが壊れている

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

練習問題２修正版：

<?php

$date = date("Y-m-d");  //日付を変数に保存

$text = $date . " : 今日もPHP頑張るぞ！\n";

$file = fopen("memo.txt", "a");

fwrite($file,$text);

fclose($file);

echo "memo.txtに追記しました\n";

?>

✅ 完全にOKです！！！💯✨
実務でも通用する書き方ができています👏

ーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーーー

🏁 Step34 最終テスト（合格したら次のステップへ）

📄 step34_final.php

要件：

フォームから送信されたメッセージを message.txt に保存

保存する形式：
2025-10-24: 〇〇（フォーム入力内容）

空欄の場合は保存せず
「内容が入力されていません」と表示

書き込み成功時は
「保存しました」と表示

フォーム側（HTML）も必要

下のHTMLも同じフォルダに作ってください👇

📄 step34_form.html

<form action="step34_final.php" method="post">
  <input type="text" name="message">
  <input type="submit" value="送信">
</form>

注意ポイント

✅ $_POST["message"] の取得
✅ 空チェックは empty()
✅ ファイル追記 "a"
✅ 日付は date("Y-m-d")
✅ 必ず fclose()

コードを2ファイルとも作成したら
step34_final.php のコードを貼ってください。
私が正誤チェックします。

合格したら…

✅ Step34 完全修了 → Step35へ進めます！🔥

がんばってください！


📄 step34_form.html

<form action="step34_final.php" method="post">
  <input type="text" name="message">
  <input type="submit" value="送信">
</form>


<?php

$message = $_POST["message"];

if (empty($message)) {
  echo "内容が入力されていません";
  exit;
}

$date = date("Y-m-d");
$text = $date . " : {$message}\n";

$file = fopen("message.txt", "a");
fwrite($file,$text);
fclose($file);

echo "保存しました\n";

?>

"a" → 既存データの下に 追加（安全）

"w" → 既存データを 全削除して書き直す（注意）